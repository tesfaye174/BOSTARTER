<!-- Auth Modals Component - Enhanced with accessibility and modern features -->

<!-- Modal Login -->
<div id="login-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50 p-4"
    role="dialog" aria-labelledby="login-title" aria-modal="true">
    <div
        class="bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 relative shadow-2xl transform transition-all duration-300 scale-95 opacity-0 modal-content">
        <!-- Close Button -->
        <button
            class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-full p-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
            onclick="closeModal('login-modal')" aria-label="Chiudi modal di accesso" type="button">
            <i class="ri-close-line text-xl" aria-hidden="true"></i>
        </button>

        <!-- Header -->
        <div class="text-center mb-6">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-primary/10 rounded-full mb-4">
                <i class="ri-user-line text-primary text-xl" aria-hidden="true"></i>
            </div>
            <h2 id="login-title" class="text-2xl font-bold text-gray-900 dark:text-white">
                Accedi a BOSTARTER
            </h2>
            <p class="text-gray-600 dark:text-gray-300 mt-2">
                Benvenuto! Accedi al tuo account per continuare
            </p>
        </div>

        <!-- Form -->
        <form id="login-form" class="space-y-5" novalidate>
            <!-- Email Field -->
            <div>
                <label for="login-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Email <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="email" id="login-email" name="email" required autocomplete="email"
                        aria-describedby="login-email-error"
                        class="w-full px-4 py-3 pl-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="inserisci@email.com">
                    <i class="ri-mail-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                </div>
                <div id="login-email-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>
            </div>

            <!-- Password Field -->
            <div>
                <label for="login-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="password" id="login-password" name="password" required autocomplete="current-password"
                        aria-describedby="login-password-error"
                        class="w-full px-4 py-3 pl-11 pr-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="La tua password">
                    <i class="ri-lock-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                    <button type="button"
                        class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
                        onclick="togglePassword('login-password')" aria-label="Mostra/nascondi password">
                        <i class="ri-eye-line" aria-hidden="true"></i>
                    </button>
                </div>
                <div id="login-password-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>
            </div>

            <!-- Remember Me & Forgot Password -->
            <div class="flex items-center justify-between">
                <label class="flex items-center">
                    <input type="checkbox" id="remember-me" name="remember"
                        class="rounded border-gray-300 text-primary focus:ring-primary">
                    <span class="ml-2 text-sm text-gray-600 dark:text-gray-300">Ricordami</span>
                </label>
                <a href="#" class="text-sm text-primary hover:text-primary-dark transition-colors"
                    onclick="showForgotPassword()">
                    Password dimenticata?
                </a>
            </div>

            <!-- Error Message -->
            <div id="login-error"
                class="text-red-500 text-sm hidden bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800"
                role="alert">
                <i class="ri-error-warning-line mr-2" aria-hidden="true"></i>
                <span class="error-message"></span>
            </div>

            <!-- Submit Button -->
            <button type="submit"
                class="w-full bg-gradient-to-r from-primary to-primary-dark text-white py-3 px-4 rounded-lg hover:from-primary-dark hover:to-primary font-semibold transition-all duration-200 transform hover:scale-[1.02] focus:ring-4 focus:ring-primary/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                <span class="flex items-center justify-center">
                    <i class="ri-login-circle-line mr-2" aria-hidden="true"></i>
                    Accedi
                </span>
            </button>
        </form>

        <!-- Divider -->
        <div class="relative my-6">
            <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
            </div>
            <div class="relative flex justify-center text-sm">
                <span class="px-2 bg-white dark:bg-gray-800 text-gray-500">oppure</span>
            </div>
        </div>

        <!-- Social Login -->
        <div class="grid grid-cols-2 gap-3 mb-6">
            <button type="button"
                class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="ri-google-fill text-red-500 mr-2" aria-hidden="true"></i>
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Google</span>
            </button>
            <button type="button"
                class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="ri-facebook-fill text-blue-600 mr-2" aria-hidden="true"></i>
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Facebook</span>
            </button>
        </div>

        <!-- Register Link -->
        <p class="text-center text-sm text-gray-600 dark:text-gray-300">
            Non hai un account?
            <a href="#" onclick="switchModal('login-modal', 'register-modal')"
                class="text-primary hover:text-primary-dark font-semibold transition-colors">
                Registrati gratuitamente
            </a>
        </p>
    </div>
</div>

<!-- Modal Registrazione -->
<div id="register-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50 p-4"
    role="dialog" aria-labelledby="register-title" aria-modal="true">
    <div
        class="bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 relative shadow-2xl transform transition-all duration-300 scale-95 opacity-0 modal-content max-h-[90vh] overflow-y-auto">
        <!-- Close Button -->
        <button
            class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-full p-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
            onclick="closeModal('register-modal')" aria-label="Chiudi modal di registrazione" type="button">
            <i class="ri-close-line text-xl" aria-hidden="true"></i>
        </button>

        <!-- Header -->
        <div class="text-center mb-6">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-green-500/10 rounded-full mb-4">
                <i class="ri-user-add-line text-green-500 text-xl" aria-hidden="true"></i>
            </div>
            <h2 id="register-title" class="text-2xl font-bold text-gray-900 dark:text-white">
                Registrati su BOSTARTER
            </h2>
            <p class="text-gray-600 dark:text-gray-300 mt-2">
                Crea il tuo account e inizia il tuo viaggio nell'innovazione
            </p>
        </div>

        <!-- Form -->
        <form id="register-form" class="space-y-5" novalidate>
            <!-- Name Field -->
            <div>
                <label for="register-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Nome completo <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="text" id="register-name" name="nome" required autocomplete="name"
                        aria-describedby="register-name-error"
                        class="w-full px-4 py-3 pl-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="Mario Rossi">
                    <i class="ri-user-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                </div>
                <div id="register-name-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>
            </div>

            <!-- Email Field -->
            <div>
                <label for="register-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Email <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="email" id="register-email" name="email" required autocomplete="email"
                        aria-describedby="register-email-error"
                        class="w-full px-4 py-3 pl-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="mario@example.com">
                    <i class="ri-mail-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                </div>
                <div id="register-email-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>
            </div>

            <!-- Password Field -->
            <div>
                <label for="register-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="password" id="register-password" name="password" required autocomplete="new-password"
                        aria-describedby="register-password-error register-password-help"
                        class="w-full px-4 py-3 pl-11 pr-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="Crea una password sicura">
                    <i class="ri-lock-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                    <button type="button"
                        class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
                        onclick="togglePassword('register-password')" aria-label="Mostra/nascondi password">
                        <i class="ri-eye-line" aria-hidden="true"></i>
                    </button>
                </div>
                <div id="register-password-help" class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                    Minimo 8 caratteri, almeno una lettera maiuscola, una minuscola e un numero
                </div>
                <div id="register-password-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>

                <!-- Password Strength Indicator -->
                <div class="mt-2">
                    <div class="flex space-x-1">
                        <div class="h-1 flex-1 bg-gray-200 dark:bg-gray-600 rounded-full">
                            <div id="password-strength-bar" class="h-full rounded-full transition-all duration-300 w-0">
                            </div>
                        </div>
                    </div>
                    <div id="password-strength-text" class="text-xs text-gray-500 dark:text-gray-400 mt-1"></div>
                </div>
            </div>

            <!-- Confirm Password Field -->
            <div>
                <label for="register-confirm-password"
                    class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Conferma Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                    <input type="password" id="register-confirm-password" name="confirm_password" required
                        autocomplete="new-password" aria-describedby="register-confirm-password-error"
                        class="w-full px-4 py-3 pl-11 pr-11 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white transition-colors"
                        placeholder="Ripeti la password">
                    <i class="ri-lock-2-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                        aria-hidden="true"></i>
                    <button type="button"
                        class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
                        onclick="togglePassword('register-confirm-password')"
                        aria-label="Mostra/nascondi conferma password">
                        <i class="ri-eye-line" aria-hidden="true"></i>
                    </button>
                </div>
                <div id="register-confirm-password-error" class="text-red-500 text-sm mt-1 hidden" role="alert"></div>
            </div>

            <!-- Account Type -->
            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                    Tipo di Account
                </label>
                <div class="grid grid-cols-2 gap-3">
                    <label class="relative cursor-pointer">
                        <input type="radio" name="user_type" value="backer" checked class="sr-only peer">
                        <div
                            class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg peer-checked:border-primary peer-checked:bg-primary/5 transition-all hover:border-gray-400 dark:hover:border-gray-500">
                            <div class="text-center">
                                <i class="ri-heart-line text-2xl text-gray-600 dark:text-gray-300 peer-checked:text-primary mb-2"
                                    aria-hidden="true"></i>
                                <div class="font-medium text-gray-900 dark:text-white">Sostenitore</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Supporta progetti innovativi</div>
                            </div>
                        </div>
                    </label>
                    <label class="relative cursor-pointer">
                        <input type="radio" name="user_type" value="creator" class="sr-only peer">
                        <div
                            class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg peer-checked:border-primary peer-checked:bg-primary/5 transition-all hover:border-gray-400 dark:hover:border-gray-500">
                            <div class="text-center">
                                <i class="ri-lightbulb-line text-2xl text-gray-600 dark:text-gray-300 peer-checked:text-primary mb-2"
                                    aria-hidden="true"></i>
                                <div class="font-medium text-gray-900 dark:text-white">Creatore</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Lancia i tuoi progetti</div>
                            </div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Terms and Privacy -->
            <div class="space-y-3">
                <label class="flex items-start space-x-3">
                    <input type="checkbox" id="accept-terms" name="accept_terms" required
                        class="mt-1 rounded border-gray-300 text-primary focus:ring-primary">
                    <span class="text-sm text-gray-600 dark:text-gray-300">
                        Accetto i <a href="#" class="text-primary hover:text-primary-dark underline">Termini di
                            Servizio</a>
                        e l'<a href="#" class="text-primary hover:text-primary-dark underline">Informativa sulla
                            Privacy</a>
                        <span class="text-red-500">*</span>
                    </span>
                </label>
                <label class="flex items-start space-x-3">
                    <input type="checkbox" id="accept-marketing" name="accept_marketing"
                        class="mt-1 rounded border-gray-300 text-primary focus:ring-primary">
                    <span class="text-sm text-gray-600 dark:text-gray-300">
                        Desidero ricevere aggiornamenti sui progetti e newsletter (opzionale)
                    </span>
                </label>
            </div>

            <!-- Error Message -->
            <div id="register-error"
                class="text-red-500 text-sm hidden bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800"
                role="alert">
                <i class="ri-error-warning-line mr-2" aria-hidden="true"></i>
                <span class="error-message"></span>
            </div>

            <!-- Submit Button -->
            <button type="submit"
                class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-4 rounded-lg hover:from-green-600 hover:to-green-700 font-semibold transition-all duration-200 transform hover:scale-[1.02] focus:ring-4 focus:ring-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                <span class="flex items-center justify-center">
                    <i class="ri-user-add-line mr-2" aria-hidden="true"></i>
                    Crea Account
                </span>
            </button>
        </form>

        <!-- Divider -->
        <div class="relative my-6">
            <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
            </div>
            <div class="relative flex justify-center text-sm">
                <span class="px-2 bg-white dark:bg-gray-800 text-gray-500">oppure</span>
            </div>
        </div>

        <!-- Social Register -->
        <div class="grid grid-cols-2 gap-3 mb-6">
            <button type="button"
                class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="ri-google-fill text-red-500 mr-2" aria-hidden="true"></i>
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Google</span>
            </button>
            <button type="button"
                class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="ri-facebook-fill text-blue-600 mr-2" aria-hidden="true"></i>
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Facebook</span>
            </button>
        </div>

        <!-- Login Link -->
        <p class="text-center text-sm text-gray-600 dark:text-gray-300">
            Hai gi√† un account?
            <a href="#" onclick="switchModal('register-modal', 'login-modal')"
                class="text-primary hover:text-primary-dark font-semibold transition-colors">
                Accedi qui
            </a>
        </p>
    </div>
</div>

<!-- Enhanced JavaScript for auth modals -->
<script>
    // Password visibility toggle
    function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const icon = input.nextElementSibling.querySelector('i');

        if (input.type === 'password') {
            input.type = 'text';
            icon.className = 'ri-eye-off-line';
        } else {
            input.type = 'password';
            icon.className = 'ri-eye-line';
        }
    }

    // Password strength checker
    function checkPasswordStrength(password) {
        let strength = 0;
        let feedback = [];

        if (password.length >= 8) strength += 1;
        else feedback.push('Minimo 8 caratteri');

        if (password.match(/[a-z]/)) strength += 1;
        else feedback.push('Una lettera minuscola');

        if (password.match(/[A-Z]/)) strength += 1;
        else feedback.push('Una lettera maiuscola');

        if (password.match(/[0-9]/)) strength += 1;
        else feedback.push('Un numero');

        if (password.match(/[^a-zA-Z0-9]/)) strength += 1;

        return { strength, feedback };
    }

    // Update password strength indicator
    function updatePasswordStrength() {
        const password = document.getElementById('register-password').value;
        const strengthBar = document.getElementById('password-strength-bar');
        const strengthText = document.getElementById('password-strength-text');

        if (!password) {
            strengthBar.style.width = '0%';
            strengthText.textContent = '';
            return;
        }

        const { strength, feedback } = checkPasswordStrength(password);
        const percentage = (strength / 5) * 100;

        strengthBar.style.width = percentage + '%';

        if (strength < 2) {
            strengthBar.className = 'h-full rounded-full transition-all duration-300 bg-red-500';
            strengthText.textContent = 'Debole - Mancano: ' + feedback.slice(0, 2).join(', ');
            strengthText.className = 'text-xs text-red-500 mt-1';
        } else if (strength < 4) {
            strengthBar.className = 'h-full rounded-full transition-all duration-300 bg-yellow-500';
            strengthText.textContent = 'Media - Mancano: ' + feedback.join(', ');
            strengthText.className = 'text-xs text-yellow-600 mt-1';
        } else {
            strengthBar.className = 'h-full rounded-full transition-all duration-300 bg-green-500';
            strengthText.textContent = 'Forte - Password sicura';
            strengthText.className = 'text-xs text-green-600 mt-1';
        }
    }

    // Modal animations
    function showModal(modalId) {
        const modal = document.getElementById(modalId);
        const content = modal.querySelector('.modal-content');

        modal.classList.remove('hidden');
        modal.classList.add('flex');

        requestAnimationFrame(() => {
            content.classList.remove('scale-95', 'opacity-0');
            content.classList.add('scale-100', 'opacity-100');
        });
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        const content = modal.querySelector('.modal-content');

        content.classList.remove('scale-100', 'opacity-100');
        content.classList.add('scale-95', 'opacity-0');

        setTimeout(() => {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }, 300);
    }

    function switchModal(fromModalId, toModalId) {
        closeModal(fromModalId);
        setTimeout(() => {
            showModal(toModalId);
        }, 300);
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function () {
        // Password strength checker
        const passwordInput = document.getElementById('register-password');
        if (passwordInput) {
            passwordInput.addEventListener('input', updatePasswordStrength);
        }

        // Close modal on backdrop click
        document.querySelectorAll('[id$="-modal"]').forEach(modal => {
            modal.addEventListener('click', function (e) {
                if (e.target === this) {
                    closeModal(this.id);
                }
            });
        });

        // Close modal on Escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('[id$="-modal"]:not(.hidden)').forEach(modal => {
                    closeModal(modal.id);
                });
            }
        });
    });
</script>